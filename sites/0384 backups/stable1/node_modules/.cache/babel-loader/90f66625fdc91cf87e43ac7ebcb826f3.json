{"ast":null,"code":"import _classCallCheck from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import axios from'axios';import{Collapse}from'react-bootstrap';import{Markup}from'interweave';import{Link}from'react-router-dom';import moment from'moment';import'moment/locale/ru';import fileImg from\"../assets/img/file.svg\";import fire from\"../assets/img/fire.svg\";var Subhomework=/*#__PURE__*/function(_React$Component){_inherits(Subhomework,_React$Component);var _super=_createSuper(Subhomework);function Subhomework(props){var _this;_classCallCheck(this,Subhomework);_this=_super.call(this,props);_this.subject_id=_this.props.subject_id;_this.state={open:false,hw:[],last:''};return _this;}_createClass(Subhomework,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var apiUrl=\"/api/subjecthomework/?id=\".concat(this.subject_id);axios.get(apiUrl).then(function(resp){if(resp.data.length>0){console.log(resp.data[0].date);_this2.setState({hw:resp.data,last:moment(resp.data[0].date).locale('ru').format('ll')});}});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"page-subdirect__hwBlock\"},this.state.hw.length>0&&/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this3.setState({open:!_this3.state.open});},\"aria-controls\":\"collapsed-block\",\"aria-expanded\":this.state.open},\"\\u0414\\u043E\\u043C\\u0430\\u0448\\u043D\\u0435\\u0435 \\u0437\\u0430\\u0434\\u0430\\u043D\\u0438\\u0435\",/*#__PURE__*/React.createElement(\"span\",null,\"\\u043F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u0435\\u0435 \\u043E\\u0442 \",this.state.last)),/*#__PURE__*/React.createElement(Collapse,{in:this.state.open},/*#__PURE__*/React.createElement(\"div\",{id:\"collapsed-block\"},this.state.hw.map(function(res,index){var deadline='';var wholeRopeWidth='';var progress='';var fromStartToNow='';var publicDate=moment(res.date);var pubicDate_startPoint=moment(res.date);var color='rgb(125 199 125)';var leftTime='';if(res.deadline!=='0000-00-00'){deadline=moment(res.deadline);wholeRopeWidth=deadline.diff(publicDate,'hours');fromStartToNow=moment().diff(pubicDate_startPoint,'hours');progress=fromStartToNow/wholeRopeWidth*100;leftTime=wholeRopeWidth-fromStartToNow;if(100-progress<=65){color='#d8e061';}if(100-progress<=35){color='#ff958a';}}var regex=/\\b(?:(?:ht|f)tp(?:s?)\\:\\/\\/|~\\/|\\/)?(?:\\w+:\\w+@)?((?:(?:[-\\w\\d{1-3}]+\\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\\.uk|ac\\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\\b25[0-5]\\b|\\b[2][0-4][0-9]\\b|\\b[0-1]?[0-9]?[0-9]\\b)(\\.(\\b25[0-5]\\b|\\b[2][0-4][0-9]\\b|\\b[0-1]?[0-9]?[0-9]\\b)){3}))(?::[\\d]{1,5})?(?:(?:(?:\\/(?:[-\\w~!$+|.,=]|%[a-f\\d]{2})+)+|\\/)+|\\?|#)?(?:(?:\\?(?:[-\\w~!$+|.,*:]|%[a-f\\d{2}])+=?(?:[-\\w~!$+|.,*:=]|%[a-f\\d]{2})*)(?:&(?:[-\\w~!$+|.,*:]|%[a-f\\d{2}])+=?(?:[-\\w~!$+|.,*:=]|%[a-f\\d]{2})*)*)*(?:#(?:[-\\w~!$ |\\/.,*:;=]|%[a-f\\d]{2})*)?\\b/gi;var replacedContent=res.content.replace(regex,function(match){return\"\\n                    <img src=\".concat(fileImg,\" width='40' />\\n                  \");});return/*#__PURE__*/React.createElement(\"div\",{key:index},deadline&&moment().isBefore(deadline)&&/*#__PURE__*/React.createElement(\"div\",{title:\"\\u0434\\u043E \\u0441\\u0434\\u0430\\u0447\\u0438 \\u043E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \".concat(Math.floor(leftTime/24),\"\\u0434 \").concat(leftTime-24*Math.floor(leftTime/24),\"\\u0447\"),style:{marginTop:'25px',width:progress?100-progress+'%':0,background:color,height:'5px',position:'relative'}},/*#__PURE__*/React.createElement(\"img\",{src:fire,width:\"25\",style:{opacity:0.8,position:'absolute',right:'-6px',top:'-18px'}})),/*#__PURE__*/React.createElement(Link,{to:{pathname:\"/view\",state:{res:res}},className:\"info-block\",key:index},/*#__PURE__*/React.createElement(\"span\",{className:\"info-block__title\"},res.title),/*#__PURE__*/React.createElement(\"span\",{className:\"info-block__content\"},/*#__PURE__*/React.createElement(Markup,{content:replacedContent.length>300?replacedContent.substring(0,300)+'...':replacedContent})),/*#__PURE__*/React.createElement(\"span\",{className:\"info-block__date\"},moment(res.date).locale('ru').format('lll')),deadline&&moment().isBefore(deadline)&&/*#__PURE__*/React.createElement(\"span\",{className:\"info-block__date info-block__date_deadline\"},\"\\u0441\\u0434\\u0430\\u0442\\u044C \\u0434\\u043E \",deadline.locale('ru').format('lll')),deadline&&moment().isAfter(deadline)&&/*#__PURE__*/React.createElement(\"span\",{className:\"info-block__date info-block__date_deadline\"},\"\\u0434\\u0435\\u0434\\u043B\\u0430\\u0439\\u043D \\u0431\\u044B\\u043B \",deadline.locale('ru').format('lll'))));}))));}}]);return Subhomework;}(React.Component);export{Subhomework as default};","map":{"version":3,"sources":["/root/0384full/src/components/subhomework.js"],"names":["React","axios","Collapse","Markup","Link","moment","Subhomework","props","subject_id","state","open","hw","last","apiUrl","get","then","resp","data","length","console","log","date","setState","locale","format","map","res","index","deadline","wholeRopeWidth","progress","fromStartToNow","publicDate","pubicDate_startPoint","color","leftTime","diff","regex","replacedContent","content","replace","match","fileImg","isBefore","Math","floor","marginTop","width","background","height","position","fire","opacity","right","top","pathname","title","substring","isAfter","Component"],"mappings":"ogBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,iBAAzB,CACA,OAASC,MAAT,KAAuB,YAAvB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,MAAO,kBAAP,C,wFAKqBC,CAAAA,W,sHACnB,qBAAYC,KAAZ,CAAmB,6CACjB,uBAAMA,KAAN,EACA,MAAKC,UAAL,CAAkB,MAAKD,KAAL,CAAWC,UAA7B,CAEA,MAAKC,KAAL,CAAa,CACXC,IAAI,CAAE,KADK,CAEXC,EAAE,CAAE,EAFO,CAGXC,IAAI,CAAE,EAHK,CAAb,CAJiB,aASlB,C,qFACmB,iBAClB,GAAMC,CAAAA,MAAM,oCAA+B,KAAKL,UAApC,CAAZ,CACAP,KAAK,CAACa,GAAN,CAAUD,MAAV,EAAkBE,IAAlB,CAAuB,SAACC,IAAD,CAAU,CAC/B,GAAIA,IAAI,CAACC,IAAL,CAAUC,MAAV,CAAmB,CAAvB,CAA0B,CACxBC,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACC,IAAL,CAAU,CAAV,EAAaI,IAAzB,EACA,MAAI,CAACC,QAAL,CAAc,CACZX,EAAE,CAAEK,IAAI,CAACC,IADG,CAEZL,IAAI,CAAEP,MAAM,CAACW,IAAI,CAACC,IAAL,CAAU,CAAV,EAAaI,IAAd,CAAN,CAA0BE,MAA1B,CAAiC,IAAjC,EAAuCC,MAAvC,CAA8C,IAA9C,CAFM,CAAd,EAID,CACF,CARD,EASD,C,uCAEQ,iBACP,mBACE,2BAAK,SAAS,CAAC,yBAAf,EACG,KAAKf,KAAL,CAAWE,EAAX,CAAcO,MAAd,CAAuB,CAAvB,eACC,8BACE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACI,QAAL,CAAc,CAAEZ,IAAI,CAAE,CAAC,MAAI,CAACD,KAAL,CAAWC,IAApB,CAAd,CAAN,EADX,CAEE,gBAAc,iBAFhB,CAGE,gBAAe,KAAKD,KAAL,CAAWC,IAH5B,6GAKE,uGAAoB,KAAKD,KAAL,CAAWG,IAA/B,CALF,CAFJ,cAUE,oBAAC,QAAD,EAAU,EAAE,CAAE,KAAKH,KAAL,CAAWC,IAAzB,eACE,2BAAK,EAAE,CAAC,iBAAR,EACG,KAAKD,KAAL,CAAWE,EAAX,CAAcc,GAAd,CAAkB,SAACC,GAAD,CAAMC,KAAN,CAAgB,CACjC,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,GAAIC,CAAAA,cAAc,CAAG,EAArB,CACA,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,GAAIC,CAAAA,cAAc,CAAG,EAArB,CACA,GAAIC,CAAAA,UAAU,CAAG3B,MAAM,CAACqB,GAAG,CAACL,IAAL,CAAvB,CACA,GAAIY,CAAAA,oBAAoB,CAAG5B,MAAM,CAACqB,GAAG,CAACL,IAAL,CAAjC,CACA,GAAIa,CAAAA,KAAK,CAAG,kBAAZ,CACA,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,GAAIT,GAAG,CAACE,QAAJ,GAAiB,YAArB,CAAmC,CACjCA,QAAQ,CAAGvB,MAAM,CAACqB,GAAG,CAACE,QAAL,CAAjB,CACAC,cAAc,CAAGD,QAAQ,CAACQ,IAAT,CAAcJ,UAAd,CAA0B,OAA1B,CAAjB,CACAD,cAAc,CAAG1B,MAAM,GAAG+B,IAAT,CAAcH,oBAAd,CAAoC,OAApC,CAAjB,CACAH,QAAQ,CAAIC,cAAc,CAAGF,cAAlB,CAAoC,GAA/C,CACAM,QAAQ,CAAGN,cAAc,CAAGE,cAA5B,CACA,GAAI,IAAMD,QAAN,EAAkB,EAAtB,CAA0B,CACxBI,KAAK,CAAG,SAAR,CACD,CACD,GAAI,IAAMJ,QAAN,EAAkB,EAAtB,CAA0B,CACxBI,KAAK,CAAG,SAAR,CACD,CACF,CAED,GAAMG,CAAAA,KAAK,CAAG,wjBAAd,CAEA,GAAMC,CAAAA,eAAe,CAAGZ,GAAG,CAACa,OAAJ,CAAYC,OAAZ,CAAoBH,KAApB,CAA2B,SAACI,KAAD,CAAW,CAC5D,+CACeC,OADf,uCAGD,CAJuB,CAAxB,CAMA,mBACE,2BAAK,GAAG,CAAEf,KAAV,EACGC,QAAQ,EAAIvB,MAAM,GAAGsC,QAAT,CAAkBf,QAAlB,CAAZ,eACC,2BACE,KAAK,wGAAuBgB,IAAI,CAACC,KAAL,CAAWV,QAAQ,CAAG,EAAtB,CAAvB,mBACHA,QAAQ,CAAG,GAAKS,IAAI,CAACC,KAAL,CAAWV,QAAQ,CAAG,EAAtB,CADb,UADP,CAIE,KAAK,CAAE,CACLW,SAAS,CAAE,MADN,CAELC,KAAK,CAAEjB,QAAQ,CAAG,IAAMA,QAAN,CAAiB,GAApB,CAA0B,CAFpC,CAGLkB,UAAU,CAAEd,KAHP,CAILe,MAAM,CAAE,KAJH,CAKLC,QAAQ,CAAE,UALL,CAJT,eAWE,2BACE,GAAG,CAAEC,IADP,CAEE,KAAK,CAAC,IAFR,CAGE,KAAK,CAAE,CACLC,OAAO,CAAE,GADJ,CAELF,QAAQ,CAAE,UAFL,CAGLG,KAAK,CAAE,MAHF,CAILC,GAAG,CAAE,OAJA,CAHT,EAXF,CAFJ,cAyBE,oBAAC,IAAD,EACE,EAAE,CAAE,CACFC,QAAQ,QADN,CAEF9C,KAAK,CAAE,CAAEiB,GAAG,CAAHA,GAAF,CAFL,CADN,CAKE,SAAS,CAAC,YALZ,CAME,GAAG,CAAEC,KANP,eAOE,4BAAM,SAAS,CAAC,mBAAhB,EAAqCD,GAAG,CAAC8B,KAAzC,CAPF,cAQE,4BAAM,SAAS,CAAC,qBAAhB,eAEI,oBAAC,MAAD,EACE,OAAO,CACLlB,eAAe,CAACpB,MAAhB,CAAyB,GAAzB,CACIoB,eAAe,CAACmB,SAAhB,CAA0B,CAA1B,CAA6B,GAA7B,EAAoC,KADxC,CAEInB,eAJR,EAFJ,CARF,cAmBE,4BAAM,SAAS,CAAC,kBAAhB,EACGjC,MAAM,CAACqB,GAAG,CAACL,IAAL,CAAN,CAAiBE,MAAjB,CAAwB,IAAxB,EAA8BC,MAA9B,CAAqC,KAArC,CADH,CAnBF,CAsBGI,QAAQ,EAAIvB,MAAM,GAAGsC,QAAT,CAAkBf,QAAlB,CAAZ,eACC,4BAAM,SAAS,CAAC,4CAAhB,iDACYA,QAAQ,CAACL,MAAT,CAAgB,IAAhB,EAAsBC,MAAtB,CAA6B,KAA7B,CADZ,CAvBJ,CA2BGI,QAAQ,EAAIvB,MAAM,GAAGqD,OAAT,CAAiB9B,QAAjB,CAAZ,eACC,4BAAM,SAAS,CAAC,4CAAhB,mEACeA,QAAQ,CAACL,MAAT,CAAgB,IAAhB,EAAsBC,MAAtB,CAA6B,KAA7B,CADf,CA5BJ,CAzBF,CADF,CA6DD,CA5FA,CADH,CADF,CAVF,CADF,CA8GD,C,yBAvIsCxB,KAAK,CAAC2D,S,SAA1BrD,W","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport { Collapse } from 'react-bootstrap';\r\nimport { Markup } from 'interweave';\r\nimport { Link } from 'react-router-dom';\r\nimport moment from 'moment';\r\nimport 'moment/locale/ru';\r\n\r\nimport fileImg from '../assets/img/file.svg';\r\nimport fire from '../assets/img/fire.svg';\r\n\r\nexport default class Subhomework extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.subject_id = this.props.subject_id;\r\n\r\n    this.state = {\r\n      open: false,\r\n      hw: [],\r\n      last: '',\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    const apiUrl = `/api/subjecthomework/?id=${this.subject_id}`;\r\n    axios.get(apiUrl).then((resp) => {\r\n      if (resp.data.length > 0) {\r\n        console.log(resp.data[0].date);\r\n        this.setState({\r\n          hw: resp.data,\r\n          last: moment(resp.data[0].date).locale('ru').format('ll'),\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"page-subdirect__hwBlock\">\r\n        {this.state.hw.length > 0 && (\r\n          <button\r\n            onClick={() => this.setState({ open: !this.state.open })}\r\n            aria-controls=\"collapsed-block\"\r\n            aria-expanded={this.state.open}>\r\n            Домашнее задание\r\n            <span>последнее от {this.state.last}</span>\r\n          </button>\r\n        )}\r\n        <Collapse in={this.state.open}>\r\n          <div id=\"collapsed-block\">\r\n            {this.state.hw.map((res, index) => {\r\n              let deadline = '';\r\n              let wholeRopeWidth = '';\r\n              let progress = '';\r\n              let fromStartToNow = '';\r\n              let publicDate = moment(res.date);\r\n              let pubicDate_startPoint = moment(res.date);\r\n              let color = 'rgb(125 199 125)';\r\n              let leftTime = '';\r\n              if (res.deadline !== '0000-00-00') {\r\n                deadline = moment(res.deadline);\r\n                wholeRopeWidth = deadline.diff(publicDate, 'hours');\r\n                fromStartToNow = moment().diff(pubicDate_startPoint, 'hours');\r\n                progress = (fromStartToNow / wholeRopeWidth) * 100;\r\n                leftTime = wholeRopeWidth - fromStartToNow;\r\n                if (100 - progress <= 65) {\r\n                  color = '#d8e061';\r\n                }\r\n                if (100 - progress <= 35) {\r\n                  color = '#ff958a';\r\n                }\r\n              }\r\n\r\n              const regex = /\\b(?:(?:ht|f)tp(?:s?)\\:\\/\\/|~\\/|\\/)?(?:\\w+:\\w+@)?((?:(?:[-\\w\\d{1-3}]+\\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\\.uk|ac\\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\\b25[0-5]\\b|\\b[2][0-4][0-9]\\b|\\b[0-1]?[0-9]?[0-9]\\b)(\\.(\\b25[0-5]\\b|\\b[2][0-4][0-9]\\b|\\b[0-1]?[0-9]?[0-9]\\b)){3}))(?::[\\d]{1,5})?(?:(?:(?:\\/(?:[-\\w~!$+|.,=]|%[a-f\\d]{2})+)+|\\/)+|\\?|#)?(?:(?:\\?(?:[-\\w~!$+|.,*:]|%[a-f\\d{2}])+=?(?:[-\\w~!$+|.,*:=]|%[a-f\\d]{2})*)(?:&(?:[-\\w~!$+|.,*:]|%[a-f\\d{2}])+=?(?:[-\\w~!$+|.,*:=]|%[a-f\\d]{2})*)*)*(?:#(?:[-\\w~!$ |\\/.,*:;=]|%[a-f\\d]{2})*)?\\b/gi;\r\n\r\n              const replacedContent = res.content.replace(regex, (match) => {\r\n                return `\r\n                    <img src=${fileImg} width='40' />\r\n                  `;\r\n              });\r\n\r\n              return (\r\n                <div key={index}>\r\n                  {deadline && moment().isBefore(deadline) && (\r\n                    <div\r\n                      title={`до сдачи осталось ${Math.floor(leftTime / 24)}д ${\r\n                        leftTime - 24 * Math.floor(leftTime / 24)\r\n                      }ч`}\r\n                      style={{\r\n                        marginTop: '25px',\r\n                        width: progress ? 100 - progress + '%' : 0,\r\n                        background: color,\r\n                        height: '5px',\r\n                        position: 'relative',\r\n                      }}>\r\n                      <img\r\n                        src={fire}\r\n                        width=\"25\"\r\n                        style={{\r\n                          opacity: 0.8,\r\n                          position: 'absolute',\r\n                          right: '-6px',\r\n                          top: '-18px',\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <Link\r\n                    to={{\r\n                      pathname: `/view`,\r\n                      state: { res },\r\n                    }}\r\n                    className=\"info-block\"\r\n                    key={index}>\r\n                    <span className=\"info-block__title\">{res.title}</span>\r\n                    <span className=\"info-block__content\">\r\n                      {\r\n                        <Markup\r\n                          content={\r\n                            replacedContent.length > 300\r\n                              ? replacedContent.substring(0, 300) + '...'\r\n                              : replacedContent\r\n                          }\r\n                        />\r\n                      }\r\n                    </span>\r\n                    <span className=\"info-block__date\">\r\n                      {moment(res.date).locale('ru').format('lll')}\r\n                    </span>\r\n                    {deadline && moment().isBefore(deadline) && (\r\n                      <span className=\"info-block__date info-block__date_deadline\">\r\n                        сдать до {deadline.locale('ru').format('lll')}\r\n                      </span>\r\n                    )}\r\n                    {deadline && moment().isAfter(deadline) && (\r\n                      <span className=\"info-block__date info-block__date_deadline\">\r\n                        дедлайн был {deadline.locale('ru').format('lll')}\r\n                      </span>\r\n                    )}\r\n                  </Link>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </Collapse>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}