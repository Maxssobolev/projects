{"ast":null,"code":"import _slicedToArray from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/root/0384full/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Markup}from'interweave';import axios from'axios';import clip from'../assets/img/link.png';import breaking from\"../assets/img/break.svg\";import chill from\"../assets/img/chill.svg\";import moment from'moment';var Calendar=/*#__PURE__*/function(_React$Component){_inherits(Calendar,_React$Component);var _super=_createSuper(Calendar);function Calendar(props){var _this;_classCallCheck(this,Calendar);_this=_super.call(this,props);_this.state={prevSub:'',currentSub:'',nextSub:'',time:Date.now(),calendar:[]};return _this;}_createClass(Calendar,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var options={weekday:'short',hour:'2-digit',minute:'2-digit',hour12:false};var prnDt=new Date().toLocaleTimeString('en-us',options);var _prnDt$split=prnDt.split(' '),_prnDt$split2=_slicedToArray(_prnDt$split,2),weekday=_prnDt$split2[0],nowTime=_prnDt$split2[1];var apiUrl=\"/api/timetable/?day=\".concat(weekday);axios.get(apiUrl).then(function(resp){if(resp.data.length>0){_this2.setState({calendar:resp.data});}});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var _this3=this;var nowTime=moment();//настоящее время\nvar prevSub='';var currentSub='';var nextSub=[];var paraStart=[];var isIbeforeAll=true,firstPara='';var calendar=this.state.calendar;if(calendar[0].flags!=='weekend'){for(var i in calendar){var startTime=moment(calendar[i].start,'HH:mm');//время начала пары\nvar endTime=moment(startTime).add({hours:1,minutes:25});//время окончания пары\n//Если пара прошла\nif(endTime.isBefore(nowTime)){prevSub={start:startTime.format('HH:mm'),end:endTime.format('HH:mm'),name:calendar[i].name,link:calendar[i].link};isIbeforeAll=false;}//Если пара идет\nelse if(startTime.isBefore(nowTime)&&nowTime.isBefore(endTime)){currentSub={start:startTime.format('HH:mm'),end:endTime.format('HH:mm'),name:calendar[i].name+(calendar[i].link?\"<img src=\".concat(clip,\" width='15' style='margin-left: 5px;'>\"):''),link:calendar[i].link};isIbeforeAll=false;}//Если пара будет\nelse if(nowTime.isBefore(startTime)){nextSub.push({start:startTime.format('HH:mm'),end:endTime.format('HH:mm'),name:calendar[i].name,link:calendar[i].link});paraStart.push(startTime);if(isIbeforeAll&&!firstPara){// Если ни одной пары еще не было, берем во фьючер первую\nvar startTimef=moment(calendar[0].start,'HH:mm');//время начала пары\nvar endTimef=moment(startTimef).add({hours:1,minutes:25});//время окончания пары\nfirstPara={startObj:startTimef,start:startTimef.format('HH:mm'),end:endTimef.format('HH:mm'),name:calendar[0].name,link:calendar[0].link};}}}if(paraStart.length>0){var different=paraStart[0].diff(nowTime);if(firstPara){var different=nowTime.diff(firstPara.startObj);}}else{var different='';}var hours=different?firstPara?parseInt(Math.abs(Math.floor(different%86400000/3600000)))-1:Math.floor(different%86400000/3600000):'';//Почему то показывает на час больше - костыляем\nvar minutes=different?Math.abs(Math.round(different%86400000%3600000/60000)):'';var result=minutes?(hours?hours+' ч ':'')+minutes+' мин':'—— - ——';setTimeout(function(){_this3.setState({prevSub:prevSub?prevSub:'',currentSub:currentSub?currentSub:{breaktime:result,name:\"\\u043F\\u0435\\u0440\\u0435\\u0440\\u044B\\u0432 <img src=\".concat(breaking,\" width='20' style='margin-bottom:5px'>\")},nextSub:nextSub?firstPara?firstPara:nextSub[0]:''});},1000);}else{//Если выходной\nsetTimeout(function(){_this3.setState({currentSub:currentSub?currentSub:{breaktime:'—— - ——',name:\"\\u0432\\u044B\\u0445\\u043E\\u0434\\u043D\\u043E\\u0439 <img src=\".concat(chill,\" width='20' style='margin-bottom:5px; transform:scale(-1,1)'>\")}});},1000);}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"calendar\"},!this.state.currentSub&&/*#__PURE__*/React.createElement(\"div\",{style:{width:'fit-content',margin:'0 auto'}},\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0440\\u0430\\u0441\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u044F...\"),this.state.prevSub&&/*#__PURE__*/React.createElement(\"div\",{className:\"prevSub\"},/*#__PURE__*/React.createElement(\"span\",{className:\"time\"},this.state.prevSub.start,\" - \",this.state.prevSub.end),/*#__PURE__*/React.createElement(\"span\",{className:\"name\"},this.state.prevSub.name)),this.state.currentSub&&/*#__PURE__*/React.createElement(\"div\",{className:\"currentSub\"},/*#__PURE__*/React.createElement(\"span\",{className:\"time\"},this.state.currentSub.start&&\"\\n              \".concat(this.state.currentSub.start,\" - \").concat(this.state.currentSub.end),this.state.currentSub.breaktime&&this.state.currentSub.breaktime),/*#__PURE__*/React.createElement(\"span\",{className:\"name\"},this.state.currentSub.link&&/*#__PURE__*/React.createElement(\"a\",{href:this.state.currentSub.link,target:\"_blank\"},/*#__PURE__*/React.createElement(Markup,{content:this.state.currentSub.name+\"<span class=\\\"now\\\">(\\u0441\\u0435\\u0439\\u0447\\u0430\\u0441)</span>\"}),' '),!this.state.currentSub.link&&!this.state.currentSub.breaktime&&/*#__PURE__*/React.createElement(Markup,{content:this.state.currentSub.name+\"<span class=\\\"now\\\">(\\u0441\\u0435\\u0439\\u0447\\u0430\\u0441)</span>\"}),!this.state.currentSub.link&&this.state.currentSub.breaktime&&/*#__PURE__*/React.createElement(Markup,{content:this.state.currentSub.name}))),this.state.nextSub&&/*#__PURE__*/React.createElement(\"div\",{className:\"nextSub\"},/*#__PURE__*/React.createElement(\"span\",{className:\"time\"},this.state.nextSub.start,\" - \",this.state.nextSub.end),/*#__PURE__*/React.createElement(\"span\",{className:\"name\"},this.state.nextSub.link&&/*#__PURE__*/React.createElement(\"a\",{href:this.state.nextSub.link,target:\"_blank\"},/*#__PURE__*/React.createElement(Markup,{content:this.state.nextSub.name+\"<img src=\".concat(clip,\" alt=\\\"(\\u0435\\u0441\\u0442\\u044C \\u0441\\u0441\\u044B\\u043B\\u043A\\u0430)\\\" width=\\\"15\\\" style='margin-left:5px' />\")})),!this.state.nextSub.link&&this.state.nextSub.name)));}}]);return Calendar;}(React.Component);export{Calendar as default};","map":{"version":3,"sources":["/root/0384full/src/components/calendar.js"],"names":["React","Markup","axios","clip","moment","Calendar","props","state","prevSub","currentSub","nextSub","time","Date","now","calendar","options","weekday","hour","minute","hour12","prnDt","toLocaleTimeString","split","nowTime","apiUrl","get","then","resp","data","length","setState","paraStart","isIbeforeAll","firstPara","flags","i","startTime","start","endTime","add","hours","minutes","isBefore","format","end","name","link","push","startTimef","endTimef","startObj","different","diff","parseInt","Math","abs","floor","round","result","setTimeout","breaktime","breaking","chill","width","margin","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Markup } from 'interweave';\r\nimport axios from 'axios';\r\nimport clip from '../assets/img/link.png';\r\nimport breaking from '../assets/img/break.svg';\r\nimport chill from '../assets/img/chill.svg';\r\n\r\nimport moment from 'moment';\r\n\r\nexport default class Calendar extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      prevSub: '',\r\n      currentSub: '',\r\n      nextSub: '',\r\n      time: Date.now(),\r\n      calendar: [],\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    var options = { weekday: 'short', hour: '2-digit', minute: '2-digit', hour12: false };\r\n    var prnDt = new Date().toLocaleTimeString('en-us', options);\r\n    const [weekday, nowTime] = prnDt.split(' ');\r\n\r\n    const apiUrl = `/api/timetable/?day=${weekday}`;\r\n    axios.get(apiUrl).then((resp) => {\r\n      if (resp.data.length > 0) {\r\n        this.setState({\r\n          calendar: resp.data,\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    let nowTime = moment(); //настоящее время\r\n\r\n    let prevSub = '';\r\n    let currentSub = '';\r\n    let nextSub = [];\r\n    let paraStart = [];\r\n    let isIbeforeAll = true,\r\n      firstPara = '';\r\n\r\n    let calendar = this.state.calendar;\r\n    if (calendar[0].flags !== 'weekend') {\r\n      for (let i in calendar) {\r\n        let startTime = moment(calendar[i].start, 'HH:mm'); //время начала пары\r\n        let endTime = moment(startTime).add({ hours: 1, minutes: 25 }); //время окончания пары\r\n\r\n        //Если пара прошла\r\n        if (endTime.isBefore(nowTime)) {\r\n          prevSub = {\r\n            start: startTime.format('HH:mm'),\r\n            end: endTime.format('HH:mm'),\r\n            name: calendar[i].name,\r\n            link: calendar[i].link,\r\n          };\r\n\r\n          isIbeforeAll = false;\r\n        }\r\n        //Если пара идет\r\n        else if (startTime.isBefore(nowTime) && nowTime.isBefore(endTime)) {\r\n          currentSub = {\r\n            start: startTime.format('HH:mm'),\r\n            end: endTime.format('HH:mm'),\r\n            name:\r\n              calendar[i].name +\r\n              (calendar[i].link ? `<img src=${clip} width='15' style='margin-left: 5px;'>` : ''),\r\n            link: calendar[i].link,\r\n          };\r\n          isIbeforeAll = false;\r\n        }\r\n        //Если пара будет\r\n        else if (nowTime.isBefore(startTime)) {\r\n          nextSub.push({\r\n            start: startTime.format('HH:mm'),\r\n            end: endTime.format('HH:mm'),\r\n            name: calendar[i].name,\r\n            link: calendar[i].link,\r\n          });\r\n          paraStart.push(startTime);\r\n\r\n          if (isIbeforeAll && !firstPara) {\r\n            // Если ни одной пары еще не было, берем во фьючер первую\r\n            let startTimef = moment(calendar[0].start, 'HH:mm'); //время начала пары\r\n            let endTimef = moment(startTimef).add({ hours: 1, minutes: 25 }); //время окончания пары\r\n            firstPara = {\r\n              startObj: startTimef,\r\n              start: startTimef.format('HH:mm'),\r\n              end: endTimef.format('HH:mm'),\r\n              name: calendar[0].name,\r\n              link: calendar[0].link,\r\n            };\r\n          }\r\n        }\r\n      }\r\n\r\n      if (paraStart.length > 0) {\r\n        var different = paraStart[0].diff(nowTime);\r\n        if (firstPara) {\r\n          var different = nowTime.diff(firstPara.startObj);\r\n        }\r\n      } else {\r\n        var different = '';\r\n      }\r\n\r\n      let hours = different\r\n        ? firstPara\r\n          ? parseInt(Math.abs(Math.floor((different % 86400000) / 3600000))) - 1\r\n          : Math.floor((different % 86400000) / 3600000)\r\n        : ''; //Почему то показывает на час больше - костыляем\r\n      let minutes = different\r\n        ? Math.abs(Math.round(((different % 86400000) % 3600000) / 60000))\r\n        : '';\r\n      let result = minutes ? (hours ? hours + ' ч ' : '') + minutes + ' мин' : '—— - ——';\r\n\r\n      setTimeout(() => {\r\n        this.setState({\r\n          prevSub: prevSub ? prevSub : '',\r\n          currentSub: currentSub\r\n            ? currentSub\r\n            : {\r\n                breaktime: result,\r\n                name: `перерыв <img src=${breaking} width='20' style='margin-bottom:5px'>`,\r\n              },\r\n          nextSub: nextSub ? (firstPara ? firstPara : nextSub[0]) : '',\r\n        });\r\n      }, 1000);\r\n    } else {\r\n      //Если выходной\r\n      setTimeout(() => {\r\n        this.setState({\r\n          currentSub: currentSub\r\n            ? currentSub\r\n            : {\r\n                breaktime: '—— - ——',\r\n                name: `выходной <img src=${chill} width='20' style='margin-bottom:5px; transform:scale(-1,1)'>`,\r\n              },\r\n        });\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"calendar\">\r\n        {!this.state.currentSub && (\r\n          <div\r\n            style={{\r\n              width: 'fit-content',\r\n              margin: '0 auto',\r\n            }}>\r\n            Загрузка расписания...\r\n          </div>\r\n        )}\r\n        {this.state.prevSub && (\r\n          <div className=\"prevSub\">\r\n            <span className=\"time\">\r\n              {this.state.prevSub.start} - {this.state.prevSub.end}\r\n            </span>\r\n\r\n            <span className=\"name\">{this.state.prevSub.name}</span>\r\n          </div>\r\n        )}\r\n        {this.state.currentSub && (\r\n          <div className=\"currentSub\">\r\n            <span className=\"time\">\r\n              {this.state.currentSub.start &&\r\n                `\r\n              ${this.state.currentSub.start} - ${this.state.currentSub.end}`}\r\n              {this.state.currentSub.breaktime && this.state.currentSub.breaktime}\r\n            </span>\r\n            <span className=\"name\">\r\n              {this.state.currentSub.link && (\r\n                <a href={this.state.currentSub.link} target=\"_blank\">\r\n                  <Markup\r\n                    content={this.state.currentSub.name + `<span class=\"now\">(сейчас)</span>`}\r\n                  />{' '}\r\n                </a>\r\n              )}\r\n\r\n              {!this.state.currentSub.link && !this.state.currentSub.breaktime && (\r\n                <Markup\r\n                  content={this.state.currentSub.name + `<span class=\"now\">(сейчас)</span>`}\r\n                />\r\n              )}\r\n              {!this.state.currentSub.link && this.state.currentSub.breaktime && (\r\n                <Markup content={this.state.currentSub.name} />\r\n              )}\r\n            </span>\r\n          </div>\r\n        )}\r\n        {this.state.nextSub && (\r\n          <div className=\"nextSub\">\r\n            <span className=\"time\">\r\n              {this.state.nextSub.start} - {this.state.nextSub.end}\r\n            </span>\r\n            <span className=\"name\">\r\n              {this.state.nextSub.link && (\r\n                <a href={this.state.nextSub.link} target=\"_blank\">\r\n                  <Markup\r\n                    content={\r\n                      this.state.nextSub.name +\r\n                      `<img src=${clip} alt=\"(есть ссылка)\" width=\"15\" style='margin-left:5px' />`\r\n                    }\r\n                  />\r\n                </a>\r\n              )}\r\n              {!this.state.nextSub.link && this.state.nextSub.name}\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}